import r,{setup as u}from"format-message";import{Store as i}from"pullstate";var e=new i({locale:null});var o={languages:[],localeFromPhone:null,defaultFallback:null,locale:null,translations:{}},s=a=>a&&!o.translations[a]?null:(o.locale=a,u({locale:o.locale,translations:o.translations[o.locale]}),e.update(t=>{t.locale=a}),a),F=({localeFromPhone:a,languages:t,defaultFallback:n=null})=>{if(o.localeFromPhone=a(),!t||!Array.isArray(t)||t.length===0){console.warn("No language packs found");return}for(let c of t){let l=c;if(!l.locale){console.warn("Check language pack for locales");continue}if(!l.translations){console.warn(`Not found "translations" object in ${l.locale} locale`);continue}o.languages.push({locale:l.locale,meta:l.meta}),o.defaultFallback||(o.defaultFallback=l.locale),o.translations[l.locale]=l.translations}return n&&!o.translations[n]?console.warn("Fallback language not found in language packs"):n&&(o.defaultFallback=n),r.setup({locale:o.defaultFallback,translations:o.translations[o.defaultFallback]}),s(o.localeFromPhone)},d=()=>{let a=e.useState(n=>n.locale||o.defaultFallback);return{getLanguages:()=>o.languages.map(n=>({selected:a===n.locale,...n})),locale:a,t:r,changeLocale:s}};export{s as changeLocale,F as initialization,d as useIntl};
