import r from"format-message";import{Store as u}from"pullstate";var s=new u({locale:null});var o={languages:[],localeFromPhone:null,defaultFallback:null,locale:null},t={translations:{}},c=n=>n&&!t.translations[n]?(console.warn(`Locale "${n}" not found`),null):(o.locale=n,console.warn("dbg:000",[o.locale,t.translations[o.locale]]),r.setup({locale:o.locale,translations:t.translations[o.locale]}),console.warn("dbg:vvv",r("dailer")),s.update(a=>{a.locale=n}),n),F=({localeFromPhone:n,languages:a,defaultFallback:e=null})=>{if(o.localeFromPhone=n(),!(!a||!Array.isArray(a)||a.length===0)){for(let i of a){let l=i;if(!l.locale){console.warn("Check language pack for locales");continue}if(!l.translations){console.warn(`Not found "translations" object in ${l.locale} locale`);continue}o.languages.push({locale:l.locale,meta:l.meta}),o.defaultFallback||(o.defaultFallback=l.locale),t.translations[l.locale]=l.translations}return e&&!t.translations[e]?console.warn("Fallback language not found in language packs"):e&&(o.defaultFallback=e),console.warn("dbg:buffer.translations",o),r.setup({locale:o.defaultFallback,translations:t.translations[o.defaultFallback]}),c(o.localeFromPhone)}},f=n=>o.languages.map(a=>({selected:n===a.locale,...a})),b=()=>{let n=s.useState(a=>a.locale||o.defaultFallback);return{getLanguages:()=>f(n),locale:n,t:r,changeLocale:c}};export{c as changeLocale,F as initialization,b as useIntl};
