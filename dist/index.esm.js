import c,{setup as f}from"format-message";import{Store as u}from"pullstate";var r=new u({locale:null});var o={languages:[],localeFromPhone:null,defaultFallback:null,locale:null},e={translations:{}},s=a=>a&&!e.translations[a]?null:(o.locale=a,f({locale:o.locale,translations:e.translations[o.locale]}),r.update(t=>{t.locale=a}),a),d=({localeFromPhone:a,languages:t,defaultFallback:l=null})=>{if(o.localeFromPhone=a(),!t||!Array.isArray(t)||t.length===0){console.warn("No language packs found");return}for(let i of t){let n=i;if(!n.locale){console.warn("Check language pack for locales");continue}if(!n.translations){console.warn(`Not found "translations" object in ${n.locale} locale`);continue}o.languages.push({locale:n.locale,meta:n.meta}),o.defaultFallback||(o.defaultFallback=n.locale),e.translations[n.locale]=n.translations}return l&&!e.translations[l]?console.warn("Fallback language not found in language packs"):l&&(o.defaultFallback=l),c.setup({locale:o.defaultFallback,translations:e.translations[o.defaultFallback]}),s(o.localeFromPhone)},h=()=>{let a=r.useState(l=>l.locale||o.defaultFallback);return{getLanguages:()=>o.languages.map(l=>({selected:a===l.locale,...l})),locale:a,t:c,changeLocale:s}};export{s as changeLocale,d as initialization,h as useIntl};
